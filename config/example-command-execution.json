{
  "ProfileName": "Command Execution Examples",
  "Description": "Demonstrates command execution actions with PowerShell and CMD",
  "MidiDevices": [
    {
      "DeviceName": "*",
      "Description": "Any MIDI device",
      "Mappings": [
        {
          "Id": "powershell-get-date",
          "Description": "Get current date and time",
          "InputType": "NoteOn",
          "Channel": 1,
          "Note": 36,
          "Action": {
            "$type": "CommandExecutionConfig",
            "Command": "Get-Date | Out-Host",
            "ShellType": "PowerShell",
            "Description": "Display current date and time in PowerShell"
          }
        },
        {
          "Id": "powershell-get-process",
          "Description": "List running processes",
          "InputType": "NoteOn",
          "Channel": 1,
          "Note": 37,
          "Action": {
            "$type": "CommandExecutionConfig",
            "Command": "Get-Process | Select-Object -First 10 | Out-Host",
            "ShellType": "PowerShell",
            "Description": "List first 10 running processes"
          }
        },
        {
          "Id": "cmd-dir-command",
          "Description": "Directory listing",
          "InputType": "NoteOn",
          "Channel": 1,
          "Note": 38,
          "Action": {
            "$type": "CommandExecutionConfig",
            "Command": "dir",
            "ShellType": "CMD",
            "Description": "List directory contents using CMD"
          }
        },
        {
          "Id": "cmd-system-info",
          "Description": "System information",
          "InputType": "NoteOn",
          "Channel": 1,
          "Note": 39,
          "Action": {
            "$type": "CommandExecutionConfig",
            "Command": "systeminfo | findstr /C:\"OS Name\" /C:\"Total Physical Memory\"",
            "ShellType": "CMD",
            "Description": "Display OS name and total memory"
          }
        },
        {
          "Id": "powershell-network-info",
          "Description": "Network adapter information",
          "InputType": "NoteOn",
          "Channel": 1,
          "Note": 40,
          "Action": {
            "$type": "CommandExecutionConfig",
            "Command": "Get-NetAdapter | Where-Object Status -eq 'Up' | Select-Object Name, InterfaceDescription | Out-Host",
            "ShellType": "PowerShell",
            "Description": "List active network adapters"
          }
        },
        {
          "Id": "cmd-ping-test",
          "Description": "Network connectivity test",
          "InputType": "NoteOn",
          "Channel": 1,
          "Note": 41,
          "Action": {
            "$type": "CommandExecutionConfig",
            "Command": "ping -n 4 8.8.8.8",
            "ShellType": "CMD",
            "Description": "Ping Google DNS 4 times"
          }
        },
        {
          "Id": "powershell-disk-space",
          "Description": "Disk space information",
          "InputType": "NoteOn",
          "Channel": 1,
          "Note": 42,
          "Action": {
            "$type": "CommandExecutionConfig",
            "Command": "Get-WmiObject -Class Win32_LogicalDisk | Select-Object DeviceID, @{Name='Size(GB)';Expression={[math]::Round($_.Size/1GB,2)}}, @{Name='FreeSpace(GB)';Expression={[math]::Round($_.FreeSpace/1GB,2)}} | Out-Host",
            "ShellType": "PowerShell",
            "Description": "Display disk space for all drives"
          }
        },
        {
          "Id": "cmd-tasklist",
          "Description": "Running tasks list",
          "InputType": "NoteOn",
          "Channel": 1,
          "Note": 43,
          "Action": {
            "$type": "CommandExecutionConfig",
            "Command": "tasklist /fi \"memusage gt 100000\" /fo table",
            "ShellType": "CMD",
            "Description": "List processes using more than 100MB memory"
          }
        },
        {
          "Id": "powershell-service-status",
          "Description": "Windows services status",
          "InputType": "NoteOn",
          "Channel": 1,
          "Note": 44,
          "Action": {
            "$type": "CommandExecutionConfig",
            "Command": "Get-Service | Where-Object Status -eq 'Running' | Select-Object -First 10 | Out-Host",
            "ShellType": "PowerShell",
            "Description": "List first 10 running Windows services"
          }
        },
        {
          "Id": "cmd-environment-vars",
          "Description": "Environment variables",
          "InputType": "NoteOn",
          "Channel": 1,
          "Note": 45,
          "Action": {
            "$type": "CommandExecutionConfig",
            "Command": "set | findstr /I \"PATH\\|TEMP\\|USER\"",
            "ShellType": "CMD",
            "Description": "Display PATH, TEMP, and USER environment variables"
          }
        },
        {
          "Id": "complex-command-sequence",
          "Description": "Complex command sequence with delays",
          "InputType": "NoteOn",
          "Channel": 1,
          "Note": 48,
          "Action": {
            "$type": "SequenceConfig",
            "SubActions": [
              {
                "$type": "CommandExecutionConfig",
                "Command": "echo Starting system check...",
                "ShellType": "CMD",
                "Description": "Display start message"
              },
              {
                "$type": "DelayConfig",
                "Milliseconds": 1000,
                "Description": "Wait 1 second"
              },
              {
                "$type": "CommandExecutionConfig",
                "Command": "Get-Date | Out-Host",
                "ShellType": "PowerShell",
                "Description": "Show current time"
              },
              {
                "$type": "DelayConfig",
                "Milliseconds": 500,
                "Description": "Wait 0.5 seconds"
              },
              {
                "$type": "CommandExecutionConfig",
                "Command": "Get-ComputerInfo | Select-Object WindowsProductName, TotalPhysicalMemory | Out-Host",
                "ShellType": "PowerShell",
                "Description": "Show system info"
              },
              {
                "$type": "DelayConfig",
                "Milliseconds": 1000,
                "Description": "Wait 1 second"
              },
              {
                "$type": "CommandExecutionConfig",
                "Command": "echo System check completed.",
                "ShellType": "CMD",
                "Description": "Display completion message"
              }
            ],
            "ErrorHandling": "ContinueOnError",
            "Description": "Complete system check sequence"
          }
        },
        {
          "Id": "conditional-command-execution",
          "Description": "Different commands based on velocity",
          "InputType": "NoteOn",
          "Channel": 1,
          "Note": 50,
          "Action": {
            "$type": "ConditionalConfig",
            "Conditions": [
              {
                "MinValue": 1,
                "MaxValue": 40,
                "Action": {
                  "$type": "CommandExecutionConfig",
                  "Command": "echo Low velocity - Basic info && date /t && time /t",
                  "ShellType": "CMD",
                  "Description": "Basic system info for low velocity"
                },
                "Description": "Soft touch -> Basic info"
              },
              {
                "MinValue": 41,
                "MaxValue": 80,
                "Action": {
                  "$type": "CommandExecutionConfig",
                  "Command": "Get-Process | Measure-Object | Select-Object Count | Out-Host",
                  "ShellType": "PowerShell",
                  "Description": "Process count for medium velocity"
                },
                "Description": "Medium touch -> Process count"
              },
              {
                "MinValue": 81,
                "MaxValue": 127,
                "Action": {
                  "$type": "CommandExecutionConfig",
                  "Command": "Get-EventLog -LogName System -Newest 5 | Select-Object TimeGenerated, EntryType, Message | Out-Host",
                  "ShellType": "PowerShell",
                  "Description": "Recent system events for high velocity"
                },
                "Description": "Hard touch -> System events"
              }
            ],
            "Description": "Velocity-sensitive command execution"
          }
        }
      ]
    }
  ]
}
