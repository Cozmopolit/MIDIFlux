{
  "ProfileName": "MIDI Output Integration Examples",
  "Description": "Examples showing MIDI Output integrated with other action types - keyboard shortcuts, mouse actions, and system commands",
  "MidiDevices": [
    {
      "DeviceName": "*",
      "Description": "Any MIDI input device - demonstrates MIDI Output combined with other actions",
      "Mappings": [
        {
          "Id": "midi-feedback-with-keypress",
          "Description": "Send MIDI feedback when pressing keyboard shortcut",
          "InputType": "NoteOn",
          "Channel": 1,
          "Note": 36,
          "Action": {
            "$type": "SequenceConfig",
            "SubActions": [
              {
                "$type": "MidiOutputConfig",
                "OutputDeviceName": "Launchpad Pro",
                "Commands": [
                  {
                    "MessageType": "NoteOn",
                    "Channel": 1,
                    "Data1": 60,
                    "Data2": 127
                  }
                ],
                "Description": "Light up feedback pad"
              },
              {
                "$type": "KeyPressReleaseConfig",
                "VirtualKeyCode": 67,
                "Description": "Press C key"
              },
              {
                "$type": "DelayConfig",
                "Milliseconds": 200,
                "Description": "Brief delay"
              },
              {
                "$type": "MidiOutputConfig",
                "OutputDeviceName": "Launchpad Pro",
                "Commands": [
                  {
                    "MessageType": "NoteOff",
                    "Channel": 1,
                    "Data1": 60,
                    "Data2": 0
                  }
                ],
                "Description": "Turn off feedback pad"
              }
            ],
            "ErrorHandling": "ContinueOnError",
            "Description": "Visual MIDI feedback for keyboard action"
          }
        },
        {
          "Id": "midi-status-with-command",
          "Description": "MIDI status indication for system commands",
          "InputType": "NoteOn",
          "Channel": 1,
          "Note": 37,
          "Action": {
            "$type": "SequenceConfig",
            "SubActions": [
              {
                "$type": "MidiOutputConfig",
                "OutputDeviceName": "Launchpad Pro",
                "Commands": [
                  {
                    "MessageType": "NoteOn",
                    "Channel": 1,
                    "Data1": 61,
                    "Data2": 100
                  }
                ],
                "Description": "Yellow status light (processing)"
              },
              {
                "$type": "CommandExecutionConfig",
                "Command": "Get-Process | Where-Object {$_.ProcessName -eq 'notepad'} | Measure-Object | Select-Object -ExpandProperty Count",
                "ShellType": "PowerShell",
                "Description": "Count Notepad processes"
              },
              {
                "$type": "DelayConfig",
                "Milliseconds": 100,
                "Description": "Brief delay"
              },
              {
                "$type": "MidiOutputConfig",
                "OutputDeviceName": "Launchpad Pro",
                "Commands": [
                  {
                    "MessageType": "NoteOff",
                    "Channel": 1,
                    "Data1": 61,
                    "Data2": 0
                  },
                  {
                    "MessageType": "NoteOn",
                    "Channel": 1,
                    "Data1": 62,
                    "Data2": 127
                  }
                ],
                "Description": "Green status light (completed)"
              },
              {
                "$type": "DelayConfig",
                "Milliseconds": 1000,
                "Description": "Show success for 1 second"
              },
              {
                "$type": "MidiOutputConfig",
                "OutputDeviceName": "Launchpad Pro",
                "Commands": [
                  {
                    "MessageType": "NoteOff",
                    "Channel": 1,
                    "Data1": 62,
                    "Data2": 0
                  }
                ],
                "Description": "Turn off status light"
              }
            ],
            "ErrorHandling": "ContinueOnError",
            "Description": "MIDI status feedback for system command"
          }
        },
        {
          "Id": "conditional-midi-output",
          "Description": "Conditional MIDI output based on CC value",
          "InputType": "ControlChange",
          "Channel": 1,
          "ControllerNumber": 1,
          "Action": {
            "$type": "ConditionalConfig",
            "Conditions": [
              {
                "MinValue": 0,
                "MaxValue": 42,
                "Action": {
                  "$type": "MidiOutputConfig",
                  "OutputDeviceName": "Launchpad Pro",
                  "Commands": [
                    {
                      "MessageType": "NoteOn",
                      "Channel": 1,
                      "Data1": 60,
                      "Data2": 50
                    }
                  ],
                  "Description": "Low value - dim red light"
                },
                "Description": "Low CC value range"
              },
              {
                "MinValue": 43,
                "MaxValue": 84,
                "Action": {
                  "$type": "MidiOutputConfig",
                  "OutputDeviceName": "Launchpad Pro",
                  "Commands": [
                    {
                      "MessageType": "NoteOn",
                      "Channel": 1,
                      "Data1": 61,
                      "Data2": 100
                    }
                  ],
                  "Description": "Medium value - bright yellow light"
                },
                "Description": "Medium CC value range"
              },
              {
                "MinValue": 85,
                "MaxValue": 127,
                "Action": {
                  "$type": "MidiOutputConfig",
                  "OutputDeviceName": "Launchpad Pro",
                  "Commands": [
                    {
                      "MessageType": "NoteOn",
                      "Channel": 1,
                      "Data1": 62,
                      "Data2": 127
                    }
                  ],
                  "Description": "High value - bright green light"
                },
                "Description": "High CC value range"
              }
            ],
            "Description": "CC fader controls Launchpad color feedback"
          }
        },
        {
          "Id": "mouse-click-with-midi-sync",
          "Description": "Mouse click synchronized with MIDI output",
          "InputType": "NoteOn",
          "Channel": 1,
          "Note": 38,
          "Action": {
            "$type": "SequenceConfig",
            "SubActions": [
              {
                "$type": "MidiOutputConfig",
                "OutputDeviceName": "Launchpad Pro",
                "Commands": [
                  {
                    "MessageType": "NoteOn",
                    "Channel": 1,
                    "Data1": 63,
                    "Data2": 127
                  }
                ],
                "Description": "Pre-click indicator"
              },
              {
                "$type": "DelayConfig",
                "Milliseconds": 50,
                "Description": "Brief pre-click delay"
              },
              {
                "$type": "MouseClickConfig",
                "Button": "Left",
                "Description": "Left mouse click"
              },
              {
                "$type": "MidiOutputConfig",
                "OutputDeviceName": "Launchpad Pro",
                "Commands": [
                  {
                    "MessageType": "NoteOff",
                    "Channel": 1,
                    "Data1": 63,
                    "Data2": 0
                  }
                ],
                "Description": "Turn off click indicator"
              }
            ],
            "ErrorHandling": "ContinueOnError",
            "Description": "Visual feedback for mouse click"
          }
        }
      ]
    }
  ]
}
